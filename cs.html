<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Agent Case Studies</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom CSS for the Case Studies Page - Grey Theme */
        :root {
            /* Grey Palette */
            --bg-main: #f1f3f5; /* Main background grey */
            --header-bg: rgba(255, 255, 255, 0.9); /* White semi-transparent header */
            --story-bg: #ffffff; /* Background for story articles */
            --text-primary: #212529; /* Very Dark Grey */
            --text-secondary: #495057; /* Dark Grey */
            --text-muted: #6c757d;   /* Medium Grey */
            --border-color: #dee2e6; /* Light Grey Border */
            --shadow-color: rgba(0, 0, 0, 0.07); /* Slightly softer shadow */
            --link-color: #0d6efd;
            --link-hover-color: #0a58ca;
            --button-bg: #e9ecef;
            --button-hover-bg: #dee2e6;
            --active-bg: #495057; /* Accent color for active states */
            --active-text: #ffffff;
        }

        body {
            background-color: var(--bg-main);
            margin: 0;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            color: var(--text-primary);
        }

        /* Header Styles */
        header {
            background: var(--header-bg);
            backdrop-filter: blur(10px);
            position: sticky; top: 0; z-index: 1000;
            box-shadow: 0 2px 8px var(--shadow-color);
            padding: 1rem 1.5rem;
        }
        .header-content {
            display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center;
            gap: 1rem; max-width: 1400px; margin: 0 auto;
        }
        .header-title {
            font-size: 1.75rem; font-weight: 700; color: var(--text-primary);
            margin: 0; flex-shrink: 0; text-decoration: none;
        }
        header nav { display: flex; gap: 1.5rem; margin: 0 auto; }
        header nav a {
            color: var(--text-secondary);
            text-decoration: none; font-weight: 500; padding: 0.5rem 0; position: relative;
            transition: color 0.3s ease; cursor: pointer;
        }
        header nav a::after {
            content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 2px;
            background-color: var(--accent-color); transition: width 0.3s ease;
        }
        header nav a:hover { color: var(--text-primary); }
        header nav a:hover::after { width: 100%; }
        .header-actions { display: flex; align-items: center; gap: 1rem; flex-shrink: 0; }

        /* Filter Dropdown Styles (Visual Only) */
        #filter-dropdown { position: relative; display: inline-block; }
        #filter-dropdown button {
            background-color: #ffffff;
            color: var(--text-secondary); padding: 10px 20px; border-radius: 20px; border: 1px solid var(--border-color);
            cursor: default; font-size: 0.9rem; font-weight: 500;
            display: flex; align-items: center; opacity: 0.6; /* Dim disabled */
        }
        #filter-dropdown button span { margin-right: 6px; }
        #filter-dropdown ul { display: none; }

        /* AI Search Styles (Now functional on this page) */
        #ai-search-container {
            display: flex; align-items: center; background-color: #ffffff;
            padding: 6px 12px; border-radius: 20px; border: 1px solid var(--border-color);
            flex-grow: 1; max-width: 400px;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
            /* opacity: 1; Removed opacity */
        }
         #ai-search-container:focus-within {
            background-color: #ffffff; box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
        }
        #ai-search-input {
            flex-grow: 1; border: none; background: transparent; outline: none;
            padding: 8px; font-size: 0.9rem; color: var(--text-primary);
        }
        #ai-search-input::placeholder { color: var(--text-muted); }
        #ai-search-button {
            background: none; border: none; cursor: pointer; padding: 6px; color: var(--text-muted);
             transition: color 0.3s ease;
        }
        #ai-search-button:hover { color: var(--text-primary); }


        /* Page Title Styles */
        .page-title {
            font-size: 2.2rem; font-weight: 700; color: var(--text-primary);
            margin-bottom: 1.5rem; padding-bottom: 0.5rem;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
        }

        /* Category Filter Grid */
        #category-filter-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* 2 columns on small screens */
            gap: 0.75rem; /* Reduced gap */
            margin-bottom: 2rem;
        }
         @media (min-width: 640px) { /* 3 columns on sm screens */
            #category-filter-grid { grid-template-columns: repeat(3, 1fr); }
         }
         @media (min-width: 1024px) { /* 6 columns on lg screens */
            #category-filter-grid { grid-template-columns: repeat(6, 1fr); }
         }
        .category-filter-btn {
            background-color: #ffffff; /* White background */
            border: 1px solid var(--border-color);
            padding: 10px 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
            font-size: 0.85rem; /* Slightly smaller font */
            white-space: nowrap; /* Prevent wrapping */
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .category-filter-btn:hover {
            background-color: #f8f9fa;
            color: var(--text-primary);
        }
        .category-filter-btn.active { /* Active category button */
            background-color: var(--accent-color);
            color: var(--active-text);
            border-color: var(--accent-color);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        /* Main Layout: Content + Index */
        .case-study-layout {
            display: flex;
            flex-direction: column; /* Stack on small screens */
            gap: 2rem;
            background-color: var(--story-bg); /* White background for the content area */
            padding: 25px 30px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            box-shadow: 0 3px 10px var(--shadow-color);
        }
         @media (min-width: 1024px) { /* Side-by-side on large screens */
            .case-study-layout { flex-direction: row; }
         }

        /* Left Column: Case Study Display Area */
        #case-study-display-area {
            flex: 3; /* Takes more space */
            min-width: 0; /* Prevents flex overflow */
            transition: opacity 0.3s ease-in-out; /* Fade transition */
        }
        #case-study-display-area.loading {
            opacity: 0.5; /* Indicate loading */
        }

        /* Right Column: Case Study Index */
        #case-study-index {
            flex: 1; /* Takes less space */
            min-width: 220px; /* Ensure minimum width */
            max-height: 75vh; /* Limit height */
            overflow-y: auto; /* Allow scrolling */
            padding-right: 10px; /* Space for scrollbar */
            border-left: 1px solid var(--border-color); /* Separator */
            padding-left: 1.5rem;
        }
         @media (max-width: 1023px) { /* Adjust index styles for stacked layout */
             #case-study-index {
                 max-height: 300px; /* Adjust height when stacked */
                 border-left: none;
                 border-top: 1px solid var(--border-color); /* Separator on top */
                 padding-left: 0;
                 padding-top: 1.5rem;
             }
         }
        #case-study-index h4 {
             font-size: 1.1rem; font-weight: 600; color: var(--text-secondary);
             margin-bottom: 1rem;
        }
        #case-study-index ul { list-style: none; padding: 0; margin: 0; }
        #case-study-index li button { /* Style index items as buttons */
             display: block; width: 100%; text-align: left;
             padding: 10px 15px; margin-bottom: 8px;
             border-radius: 8px; border: 1px solid transparent; /* Transparent border for spacing */
             background: none; color: var(--text-secondary); font-size: 0.9rem;
             cursor: pointer; transition: background-color 0.2s ease, color 0.2s ease;
        }
        #case-study-index li button:hover {
             background-color: #e9ecef; color: var(--text-primary);
        }
        #case-study-index li button.active { /* Style for selected index item */
             background-color: var(--accent-color); color: var(--active-text); font-weight: 500;
        }
        #case-study-index li button span { /* Optional: category hint */
             display: block; font-size: 0.75rem; color: var(--text-muted); margin-top: 2px;
        }
         #case-study-index li button.active span {
             color: rgba(255,255,255,0.7);
         }

        /* Case Study Story Styles (within display area) */
        .case-study-story {
            padding: 0; margin-bottom: 0;
            opacity: 1; transform: none; animation: fadeInView 0.4s ease; /* Fade in content */
        }
        @keyframes fadeInView { /* Simple fade-in for content swap */
             from { opacity: 0; }
             to { opacity: 1; }
        }
        .case-study-story h3 { /* Agent Title */
            font-size: 1.8rem; font-weight: 600; color: var(--text-primary);
            margin-bottom: 15px; padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color); display: flex; align-items: center;
        }
         .case-study-story .app-icon { /* Icon next to title */
            width: 45px; height: 45px; border-radius: 10px; margin-right: 15px; font-size: 18px;
            background-color: #f8f9fa; display: flex; justify-content: center; align-items: center;
            font-weight: 600; color: var(--text-secondary);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); flex-shrink: 0; overflow: hidden;
        }
         .case-study-story .app-icon img { width: 100%; height: 100%; object-fit: cover; }

        .case-study-story h4 { /* Section Titles */
            font-size: 1.15rem; font-weight: 600; color: var(--text-secondary);
            margin-top: 1.75rem; margin-bottom: 0.75rem;
        }
        .case-study-story p { /* Paragraph text */
            font-size: 0.95rem; color: var(--text-secondary); line-height: 1.7;
            margin-bottom: 1rem;
        }
         .case-study-story .outcome strong {
             color: var(--text-primary); font-weight: 600;
         }
        .case-study-links {
            margin-top: 1.5rem; padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }
        .case-study-links a {
            display: inline-block; margin-right: 15px; color: var(--link-color);
            text-decoration: none; font-weight: 500; font-size: 0.9rem;
            transition: color 0.2s ease;
        }
        .case-study-links a:hover { color: var(--link-hover-color); text-decoration: underline; }

        /* Main Content Area */
        main {
            padding: 2rem 1.5rem; max-width: 1400px; /* Use max-width */
            margin: 1rem auto 2rem auto;
            width: 100%; box-sizing: border-box;
        }

        /* Responsive Adjustments */
        @media (max-width: 1024px) {
            .header-content { justify-content: space-between; }
            header nav { order: 3; width: 100%; justify-content: center; margin-top: 0.5rem; gap: 1rem;}
            .header-actions { order: 2; }
            .header-title { order: 1; }
            #ai-search-container { max-width: 300px; }
             .case-study-layout { flex-direction: column; } /* Stack columns earlier */
             #case-study-index { max-height: 300px; border-left: none; border-top: 1px solid var(--border-color); padding-left: 0; padding-top: 1.5rem; }
        }
        @media (max-width: 768px) {
             header { padding: 0.75rem 1rem; }
             .header-title { font-size: 1.5rem; }
             header nav { gap: 0.75rem; }
             header nav a { font-size: 0.9rem; padding: 0.3rem 0; }
             .header-actions { flex-wrap: wrap; justify-content: flex-end; gap: 0.5rem; }
             #ai-search-container { width: 100%; max-width: none; order: 1; margin-right: 0; }
             #filter-dropdown { order: 2; }
             #filter-dropdown button { padding: 8px 16px; }
             main { padding: 1.5rem 1rem; margin: 1rem auto; }
             .page-title { font-size: 1.8rem; }
             .section-title { font-size: 1.5rem; }
             .intro-text { font-size: 1rem; }
             #category-filter-grid { grid-template-columns: repeat(2, 1fr); } /* 2 columns on small */
             .case-study-story { padding: 0; } /* Remove padding for story on mobile */
             .case-study-story h3 { font-size: 1.5rem; }
             .case-study-story h4 { font-size: 1.1rem; margin-top: 1.25rem;}
             .case-study-story p { font-size: 0.9rem; }
             .case-study-layout { padding: 15px 20px; } /* Adjust frame padding */
        }

    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <a href="https://synapster.analystx.uk/" class="header-title">AI Agent Marketplace</a>
            <nav>
                <a href="https://synapster.analystx.uk/cs.html">Case Studies</a>
                <a href="https://synapster.analystx.uk/agents.html">Agents List</a>
                <a href="https://synapster.analystx.uk/discussion.html">Forum</a>
                <a href="#">About Us</a>
            </nav>
            <div class="header-actions">
                <div id="ai-search-container">
                    <input type="text" id="ai-search-input" placeholder="Search case studies...">
                    <button id="ai-search-button" aria-label="Search">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                    </button>
                </div>
                <div id="filter-dropdown">
                    <button disabled>
                        <span>Filter</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m7 10 5 5 5-5"/></svg>
                    </button>
                    <ul></ul>
                </div>
            </div>
        </div>
        <div id="ai-response-area"></div> </header>

    <main>
        <h1 class="page-title">AI Agent Case Studies</h1>

        <div id="page-frame-container">

            <div id="category-filter-grid">
                 <button class="category-filter-btn active" data-category="all">All Case Studies</button>
                 <button class="category-filter-btn" data-category="diagnostics-imaging">Diagnostics</button>
                 <button class="category-filter-btn" data-category="clinical-decision">Clinical Decision</button>
                 <button class="category-filter-btn" data-category="patient-engagement">Patient Engagement</button>
                 <button class="category-filter-btn" data-category="operational-efficiency">Operations</button>
                 <button class="category-filter-btn" data-category="drug-discovery">Research</button>
            </div>

            <div class="case-study-layout">
                <div id="case-study-display-area">
                    <p class="text-center text-muted py-10">Select a case study from the index to view details.</p>
                </div>
                <div id="case-study-index">
                    <h4>Case Study Index</h4>
                    <ul id="case-study-index-list">
                        </ul>
                </div>
            </div>

        </div> </main>

    <script>
      try { // Add error handling wrapper

        // --- Category Mapping (Slug to Full Name) ---
        const categoryMap = {
            'all': 'All Categories',
            'diagnostics-imaging': 'Diagnostics & Imaging Solutions',
            'clinical-decision': 'Clinical Decision Support & Triage',
            'patient-engagement': 'Patient Engagement & Remote Care',
            'operational-efficiency': 'Operational Efficiency & Administration',
            'drug-discovery': 'Drug Discovery & Research'
        };

        // --- Case Study Data (Extracted from appData) ---
        const caseStudiesData = [
            { appId: 'diag01', title: 'Zebra Medical Vision', category: 'diagnostics-imaging', icon: 'ZMV', iconUrl: 'https://placehold.co/80x80/ADB5BD/ffffff?text=ZMV', caseStudy: { country: 'United Kingdom', improvement: 'Reduced diagnostic report turnaround time by 25% in NHS trusts, leading to faster treatment decisions.', problem: 'Significant backlogs in interpreting diagnostic images (X-rays, CT scans) led to delays in patient diagnosis and treatment initiation. Radiologist workload was high, contributing to burnout.', solution: 'The AI platform was integrated into the existing PACS system, automatically analysing incoming scans, flagging potential abnormalities and prioritising urgent cases for radiologist review. The AI acted as a "second reader".'} },
            { appId: 'diag02', title: 'Rad AI', category: 'diagnostics-imaging', icon: 'RAI', iconUrl: 'https://placehold.co/80x80/CED4DA/ffffff?text=RAI', caseStudy: { country: 'USA', improvement: 'Automated report generation saved radiologists an average of 60 minutes per day at a California-based health system.', problem: 'A large California-based health system struggled with the time radiologists spent on repetitive reporting tasks and ensuring consistent report quality, detracting from complex image interpretation.', solution: 'Rad AI\'s tools integrated into the workflow, automatically generating customisable report templates populated with data and standard language, reducing manual dictation and formatting time.'} },
            { appId: 'diag03', title: 'Gleamer', category: 'diagnostics-imaging', icon: 'GLM', iconUrl: 'https://placehold.co/80x80/DEE2E6/495057?text=GLM', caseStudy: { country: 'France', improvement: 'Improved fracture detection accuracy by 15% in emergency rooms, reducing misdiagnosis rates.', problem: 'Emergency departments faced challenges with the speed and accuracy of preliminary fracture detection on X-rays, especially during busy periods, leading to missed fractures.', solution: 'BoneView was implemented alongside standard review, analysing X-rays and highlighting suspected fracture sites directly on the image, serving as a crucial aid for subtle or complex fractures.'} },
            { appId: 'clin01', title: 'Pieces', category: 'clinical-decision', icon: 'PCS', iconUrl: 'https://placehold.co/80x80/6C757D/ffffff?text=PCS', caseStudy: { country: 'USA', improvement: 'Helped a Dallas hospital reduce readmission rates for high-risk patients by 18% through better care coordination.', problem: 'A major Dallas hospital identified high readmission rates among patients with complex conditions, often exacerbated by fragmented communication and siloed data.', solution: 'The Pieces platform integrated clinical and social determinants data, using AI to identify high-risk patients in real-time and alert care managers to specific needs, enabling proactive interventions.'} },
            { appId: 'clin02', title: 'Visiba', category: 'clinical-decision', icon: 'VIS', iconUrl: 'https://placehold.co/80x80/ADB5BD/ffffff?text=VIS', caseStudy: { country: 'Sweden', improvement: 'Directed 30% more patients to the appropriate level of care (nurse, physio, GP) on first contact, optimising resource use.', problem: 'Urgent care centres faced high volumes and difficulties efficiently directing patients to the correct care pathway based on initial contact, causing bottlenecks.', solution: 'Patients used an online portal; Visiba Triage AI analysed symptoms, suggested urgency/diagnoses, and provided a structured summary to the clinical team for faster, informed routing decisions.'} },
            { appId: 'clin03', title: 'Klinik Healthcare Solutions', category: 'clinical-decision', icon: 'KHS', iconUrl: 'https://placehold.co/80x80/CED4DA/495057?text=KHS', caseStudy: { country: 'Finland', improvement: 'Reduced unnecessary GP appointments by 20% in primary care centres by accurately assessing patient needs online.', problem: 'Primary care centres were overwhelmed with high call volumes and administrative workload for booking and assessment, hindering timely patient access.', solution: 'The online platform allowed patients to submit enquiries; AI assessed urgency and directed the query to the most suitable resource (GP, nurse, pharmacist), reducing phone traffic.'} },
            { appId: 'pat01', title: 'Memora Health', category: 'patient-engagement', icon: 'MEM', iconUrl: 'https://placehold.co/80x80/DEE2E6/ffffff?text=MEM', caseStudy: { country: 'USA', improvement: 'Increased patient adherence to post-operative instructions by 40% through automated check-ins and reminders.', problem: 'A hospital system observed low adherence to complex post-operative instructions, leading to complications. Manual follow-up was difficult to scale.', solution: 'The platform automated SMS communication, sending personalised reminders and using AI chat for common questions, flagging concerns for clinical review.'} },
            { appId: 'pat02', title: 'Ada Health', category: 'patient-engagement', icon: 'ADA', iconUrl: 'https://placehold.co/80x80/E9ECEF/495057?text=ADA', caseStudy: { country: 'Germany', improvement: 'Provided preliminary symptom assessments for over 10 million users, guiding them towards appropriate care options.', problem: 'Patients often struggled to understand symptoms or determine the appropriate level of care needed, leading to inefficient use of emergency services or delayed care.', solution: 'The Ada app allowed users to input symptoms; AI asked relevant questions and provided reports outlining possible causes and recommended next steps.'} },
            { appId: 'pat03', title: 'Biofourmis', category: 'patient-engagement', icon: 'BIO', iconUrl: 'https://placehold.co/80x80/F8F9FA/6C757D?text=BIO', caseStudy: { country: 'Singapore', improvement: 'Enabled early detection of heart failure decompensation in remotely monitored patients, reducing hospitalisations by 30%.', problem: 'Detecting early signs of worsening chronic heart failure in remotely managed patients was challenging, often leading to avoidable emergency hospitalisations.', solution: 'Wearable sensors collected data analysed by the Biovitals® AI platform, which detected subtle changes indicating potential issues, alerting clinicians for proactive intervention.'} },
            { appId: 'ops01', title: 'Avaamo', category: 'operational-efficiency', icon: 'AVA', iconUrl: 'https://placehold.co/80x80/ADB5BD/ffffff?text=AVA', caseStudy: { country: 'India', improvement: 'Automated appointment scheduling for a large hospital network, reducing call centre volume by 35%.', problem: 'A large hospital network faced operational inefficiencies due to high call volumes for appointments and basic inquiries, straining staff resources.', solution: 'AI virtual assistants deployed on the website and phone system handled routine tasks like booking, FAQs, and pre-appointment guidance, freeing up staff.'} },
            { appId: 'ops02', title: 'AKASA', category: 'operational-efficiency', icon: 'AKA', iconUrl: 'https://placehold.co/80x80/6C757D/ffffff?text=AKA', caseStudy: { country: 'USA', improvement: 'Reduced claim denial rates by 22% and accelerated payment cycles for multiple healthcare providers.', problem: 'Healthcare providers experienced revenue loss and administrative burden due to medical coding errors, complex billing, and high claim denial rates.', solution: 'The AI platform integrated with EHR/billing systems to automate tasks, correct coding errors pre-submission, predict denials, and manage appeals.'} },
            { appId: 'ops03', title: 'Augmedix', category: 'operational-efficiency', icon: 'AUG', iconUrl: 'https://placehold.co/80x80/CED4DA/495057?text=AUG', caseStudy: { country: 'USA', improvement: 'Saved primary care physicians an average of 2-3 hours per day on documentation, improving job satisfaction.', problem: 'Physicians reported high burnout levels largely due to the burden of clinical documentation within EHRs, reducing time for patient interaction.', solution: 'AI-assisted remote medical documentation specialists generated draft clinical notes in real-time during patient visits, which were then finalised, significantly cutting physician documentation time.'} },
            { appId: 'drug01', title: 'Atomwise', category: 'drug-discovery', icon: 'ATW', iconUrl: 'https://placehold.co/80x80/DEE2E6/ffffff?text=ATW', caseStudy: { country: 'Global (Partnerships)', improvement: 'Identified potential drug candidates for various targets significantly faster than traditional high-throughput screening methods.', problem: 'Traditional drug discovery faced bottlenecks in the early hit-finding stage due to the time and cost of high-throughput screening (HTS).', solution: 'The AtomNet® AI platform used deep learning to predict molecule binding affinity, identifying novel hit compounds faster and more cost-effectively than HTS.'} },
            { appId: 'drug02', title: 'Isomorphic Labs', category: 'drug-discovery', icon: 'ISO', iconUrl: 'https://placehold.co/80x80/E9ECEF/495057?text=ISO', caseStudy: { country: 'UK/Global', improvement: 'Advanced protein structure prediction capabilities (AlphaFold), fundamentally accelerating biological research worldwide.', problem: 'Determining the 3D structure of proteins experimentally was often slow, expensive, or impossible, hindering drug design and biological understanding.', solution: 'AI systems like AlphaFold were developed to predict protein structures accurately from amino acid sequences, providing invaluable tools for global researchers.'} },
            { appId: 'drug03', title: 'XtalPi', category: 'drug-discovery', icon: 'XTP', iconUrl: 'https://placehold.co/80x80/F8F9FA/6C757D?text=XTP', caseStudy: { country: 'USA/China', improvement: 'Utilised AI and physics-based models to predict crystal structures, shortening pre-clinical development timelines.', problem: 'Predicting and controlling the solid-state properties (like crystal structure) of drug candidates was often a slow, trial-and-error process.', solution: 'The platform combined quantum physics calculations, AI predictions, and robotics to accurately predict solid-state properties, guiding experiments and optimising candidate selection.'} },
            { appId: 'drug04', title: 'Healx', category: 'drug-discovery', icon: 'HLX', iconUrl: 'https://placehold.co/80x80/ADB5BD/ffffff?text=HLX', caseStudy: { country: 'UK', improvement: 'Identified potential treatments for rare diseases by repurposing existing drugs, moving candidates towards clinical trials faster.', problem: 'Developing treatments for rare diseases faced challenges due to small patient populations and the high cost/risk of traditional drug development.', solution: 'The Healnet AI platform analysed vast biomedical data to find non-obvious links between existing drugs and rare diseases, accelerating the identification of potential repurposed treatments.'} }
        ];


        // --- DOM Element References ---
        const caseStudyDisplayArea = document.getElementById('case-study-display-area');
        const caseStudyIndexList = document.getElementById('case-study-index-list');
        const categoryFilterGrid = document.getElementById('category-filter-grid');
        const aiSearchInput = document.getElementById('ai-search-input'); // Search Input
        const aiSearchButton = document.getElementById('ai-search-button'); // Search Button

        // Check if critical elements exist
        if (!caseStudyDisplayArea || !caseStudyIndexList || !categoryFilterGrid || !aiSearchInput || !aiSearchButton) {
            console.error("Initialization Error: One or more page elements not found.");
        }

        // --- State ---
        let currentCaseStudyCategory = 'all';

        // --- Helper to generate fictional content ---
        const generateFictionalContent = (app) => {
            const methodology = app.caseStudy.solution || `The ${app.title || 'AI'} platform was implemented within the client's existing infrastructure. It leveraged its core AI capabilities, processing relevant data streams (e.g., ${app.category === 'diagnostics-imaging' ? 'medical images, reports' : app.category === 'patient-engagement' ? 'wearable data, patient communications' : 'operational metrics, EHR data'}) to provide actionable insights. Integration with systems like PACS or EHR was established where necessary to ensure seamless workflow. Staff were trained on utilising the platform's outputs for enhanced decision-making.`;
            const conclusion = `The deployment successfully addressed the core problem statement. Key outcomes included: ${app.caseStudy.improvement}. This demonstrates the effectiveness of ${app.title || 'the AI agent'} in enhancing healthcare efficiency and outcomes in ${app.caseStudy.country || 'this region'}.`;
            const recommendation = `Based on the positive results observed in ${app.caseStudy.country || 'this study'}, wider adoption of ${app.title || 'this AI solution'} is recommended for similar healthcare settings facing challenges in ${categoryMap[app.category] || 'related fields'}. Further investigation into long-term cost-benefit analysis and patient satisfaction metrics would provide additional valuable insights.`;
            const nextStep = `The next phase involves ongoing monitoring of key performance indicators to ensure sustained improvements. Potential expansions include integrating additional data sources or applying the AI agent to related clinical or operational areas. Continuous user feedback collection is planned to guide future refinements and updates to the platform.`;
            const intro = `A leading healthcare provider in ${app.caseStudy.country || 'the region'} sought to innovate within the area of ${categoryMap[app.category] || 'healthcare services'}. Facing increasing demands and complexity, they partnered with ${app.title || 'an AI solutions provider'} to explore how artificial intelligence could address specific operational or clinical challenges and improve overall service delivery.`;
            return { methodology, conclusion, recommendation, nextStep, intro };
        };

        // --- Function to Display a Single Case Study Story ---
        function displaySingleCaseStudyById(appId) {
             if (!caseStudyDisplayArea) return;

             const app = caseStudiesData.find(item => item.appId === appId);

             if (!app || !app.caseStudy) {
                 caseStudyDisplayArea.innerHTML = '<p class="text-center text-muted py-10">Case study details not available.</p>';
                 return;
             };

             console.log("[Display] Displaying case study for:", app.title); // Debug
             caseStudyDisplayArea.classList.add('loading'); // Indicate loading start

             const fallbackImage = `this.onerror=null; this.parentElement.textContent = '${app.icon || '?'}'; this.parentElement.style.fontSize='18px'; this.parentElement.style.fontWeight='600';`;
             const fictional = generateFictionalContent(app);

             // Build the story HTML
             const storyHTML = `
                 <div class="case-study-story">
                     <h3>
                         <div class="app-icon">
                              <img src="${app.iconUrl || '#'}" alt="${app.title || 'Agent'} icon" loading="lazy" onerror="${fallbackImage}">
                         </div>
                         ${app.title || 'Unknown Agent'} Case Study
                     </h3>
                     <h4>Introduction</h4>
                     <p>${fictional.intro}</p>
                     <h4>Problem Statement</h4>
                     <p>${app.caseStudy.problem || 'Details not available.'}</p>
                     <h4>Methodology</h4>
                     <p>${fictional.methodology}</p>
                     <h4>Conclusion & Outcome</h4>
                     <p class="outcome">${fictional.conclusion}</p>
                     <h4>Recommendation</h4>
                     <p>${fictional.recommendation}</p>
                     <h4>Next Steps</h4>
                     <p>${fictional.nextStep}</p>
                     <div class="case-study-links">
                         <a href="#" target="_blank" rel="noopener noreferrer">Read Full Study (Placeholder)</a>
                         <a href="#" target="_blank" rel="noopener noreferrer">Visit Product Page (Placeholder)</a>
                     </div>
                 </div>
             `;
             // Use a small timeout to allow the 'loading' class effect to be visible
             setTimeout(() => {
                caseStudyDisplayArea.innerHTML = storyHTML;
                caseStudyDisplayArea.classList.remove('loading');
             }, 100); // 100ms delay

             // Update active state in index
             if(caseStudyIndexList) {
                caseStudyIndexList.querySelectorAll('button').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.appid === appId);
                });
             }
         }

        // --- Function to Populate Case Study Index ---
        function populateIndex(filteredStudies) {
            if (!caseStudyIndexList || !caseStudyDisplayArea) return;
            caseStudyIndexList.innerHTML = ''; // Clear previous index

            if (filteredStudies.length === 0) {
                caseStudyIndexList.innerHTML = '<li class="text-muted text-sm p-3">No studies found matching your criteria.</li>';
                caseStudyDisplayArea.innerHTML = '<p class="text-center text-muted py-10">No case studies match the selected filter or search term.</p>';
            } else {
                filteredStudies.forEach((study) => {
                    const listItem = document.createElement('li');
                    const button = document.createElement('button');
                    button.dataset.appid = study.appId;
                    button.innerHTML = `${study.title || 'Unknown'} <span>${categoryMap[study.category] || study.category || 'N/A'}</span>`;
                    button.addEventListener('click', () => displaySingleCaseStudyById(study.appId));
                    listItem.appendChild(button);
                    caseStudyIndexList.appendChild(listItem);
                });
                // Display the first study in the filtered list by default
                displaySingleCaseStudyById(filteredStudies[0].appId);
            }
        }

        // --- Function to Filter Case Studies by Category ---
        function filterCaseStudiesByCategory(category) {
            if (!categoryFilterGrid) return;
            currentCaseStudyCategory = category; // Update state
            console.log("[Filter] Filtering by category:", category); // Debug

            // Clear search input when category changes
            if(aiSearchInput) aiSearchInput.value = '';

            const filteredData = (category === 'all')
                ? caseStudiesData
                : caseStudiesData.filter(study => study.category === category);

            populateIndex(filteredData); // Repopulate index and display first item

            // Update active state for category buttons
            const categoryButtons = categoryFilterGrid.querySelectorAll('.category-filter-btn');
            categoryButtons.forEach(btn => {
                 btn.classList.toggle('active', btn.dataset.category === category);
             });
        }

         // --- Function to Search Case Studies ---
         function searchCaseStudies(query) {
             if (!categoryFilterGrid) return;
             const lowerCaseQuery = query.toLowerCase().trim();
             console.log("[Search] Searching case studies for:", lowerCaseQuery); // Debug

             if (!lowerCaseQuery) {
                 // If search is cleared, revert to the last selected category (or 'all')
                 filterCaseStudiesByCategory(currentCaseStudyCategory || 'all');
                 return;
             }

             const filteredData = caseStudiesData.filter(study => {
                 const titleMatch = study.title?.toLowerCase().includes(lowerCaseQuery);
                 const problemMatch = study.caseStudy?.problem?.toLowerCase().includes(lowerCaseQuery);
                 const solutionMatch = study.caseStudy?.solution?.toLowerCase().includes(lowerCaseQuery);
                 const improvementMatch = study.caseStudy?.improvement?.toLowerCase().includes(lowerCaseQuery);
                 // Add more fields to search if needed (e.g., fictional content)
                 // const fictional = generateFictionalContent(study);
                 // const introMatch = fictional.intro?.toLowerCase().includes(lowerCaseQuery);
                 // const conclusionMatch = fictional.conclusion?.toLowerCase().includes(lowerCaseQuery);

                 return titleMatch || problemMatch || solutionMatch || improvementMatch; // || introMatch || conclusionMatch;
             });

             populateIndex(filteredData); // Repopulate index with search results

             // Deactivate all category buttons when search is active
             const categoryButtons = categoryFilterGrid.querySelectorAll('.category-filter-btn');
             categoryButtons.forEach(btn => btn.classList.remove('active'));
         }


        // --- Initialisation on Page Load ---
        document.addEventListener('DOMContentLoaded', () => {
            try {
                console.log("DOM Loaded for Case Studies Page"); // Debug

                // Add listeners to category buttons
                const categoryButtons = categoryFilterGrid?.querySelectorAll('.category-filter-btn');
                if (categoryButtons) {
                    categoryButtons.forEach(button => {
                        button.addEventListener('click', () => filterCaseStudiesByCategory(button.dataset.category));
                    });
                } else {
                     console.error("Category filter buttons not found.");
                }

                 // Add listeners for search input
                 if(aiSearchButton && aiSearchInput) {
                     aiSearchButton.addEventListener('click', () => searchCaseStudies(aiSearchInput.value));
                     aiSearchInput.addEventListener('keypress', (event) => {
                         if (event.key === 'Enter') {
                             event.preventDefault(); // Prevent form submission (if any)
                             searchCaseStudies(aiSearchInput.value);
                         }
                     });
                 } else {
                     console.error("Search input or button not found.");
                 }

                // Initial population
                filterCaseStudiesByCategory('all'); // Show all initially

            } catch (error) {
                console.error("Error during initial page load:", error);
                const body = document.querySelector('body');
                 if (body) {
                     body.innerHTML = '<p style="padding: 20px; text-align: center; color: red;">Sorry, the application could not be loaded. Please check the console for errors.</p>';
                 }
            }
        });

      } catch (e) { // Catch errors during script setup phase
            console.error("Critical error during script setup:", e);
            const body = document.querySelector('body');
            if (body) {
                 body.innerHTML = '<p style="padding: 20px; text-align: center; color: red;">A critical error occurred while setting up the page. Please check the console.</p>';
            }
      }
    </script>

</body>
</html>
