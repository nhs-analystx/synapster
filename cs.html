<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Agent Marketplace</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom CSS for the grey theme and enhanced dynamic feel */
        :root {
            /* Grey Palette */
            --bg-main: #f1f3f5; /* Main background grey */
            --header-bg: rgba(255, 255, 255, 0.9); /* White semi-transparent header */
            --card-bg: #ffffff; /* White cards */
            --card-hover-bg: #ffffff;
            --story-bg: #ffffff; /* Background for story articles */
            --frame-bg: #ffffff; /* Background for frame containers */
            --tooltip-bg: rgba(33, 37, 41, 0.9); /* Dark tooltip */
            --tooltip-text: #f8f9fa; /* Light tooltip text */
            --text-primary: #212529; /* Very Dark Grey */
            --text-secondary: #495057; /* Dark Grey */
            --text-muted: #6c757d;   /* Medium Grey */
            --border-color: #dee2e6; /* Light Grey Border */
            --accent-color: #495057;  /* Dark Grey for accents */
            --accent-hover-color: #212529; /* Very Dark Grey for hover */
            --shadow-color: rgba(0, 0, 0, 0.07); /* Slightly softer shadow */
            --star-color: #fbbc05;
            --featured-color: #ffeb3b;
            --link-color: #0d6efd; /* Standard blue link color */
            --link-hover-color: #0a58ca;
            --section-bg-light: #ffffff;
            --section-bg-dark: #f8f9fa; /* Slightly off-white */
        }

        html {
             scroll-behavior: smooth;
        }

        body {
            background-color: var(--bg-main);
            animation: fadeInBackground 1s ease forwards;
            margin: 0;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            color: var(--text-primary);
        }

        @keyframes fadeInBackground {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Loading Screen Styles */
        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(255, 255, 255, 0.98);
            display: flex; justify-content: center; align-items: center;
            z-index: 10000;
            transition: opacity 0.7s ease-out;
        }
        #loading-screen.fade-out { opacity: 0; visibility: hidden; }
        .loader {
            border: 6px solid #e9ecef; border-top: 6px solid var(--accent-color);
            border-radius: 50%; width: 50px; height: 50px;
            animation: spin 1.5s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Header Styles */
        header {
            background: var(--header-bg);
            backdrop-filter: blur(10px);
            position: sticky; top: 0; z-index: 1000;
            box-shadow: 0 2px 8px var(--shadow-color);
            padding: 1rem 1.5rem;
        }
        .header-content {
            display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center;
            gap: 1rem; max-width: 1400px; margin: 0 auto;
        }
        .header-title {
            font-size: 1.75rem; font-weight: 700; color: var(--text-primary);
            margin: 0; flex-shrink: 0; text-decoration: none;
        }
        header nav { display: flex; gap: 1.5rem; margin: 0 auto; }
        header nav a {
            color: var(--text-secondary);
            text-decoration: none; font-weight: 500; padding: 0.5rem 0; position: relative;
            transition: color 0.3s ease; cursor: pointer;
        }
        header nav a::after {
            content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 2px;
            background-color: var(--accent-color); transition: width 0.3s ease;
        }
        header nav a:hover,
        header nav a.active { color: var(--text-primary); }
        header nav a.active::after { width: 100%; }
        .header-actions { display: flex; align-items: center; gap: 1rem; flex-shrink: 0; }

        /* Card Base Styles (Shared by App/Agent cards) */
        .card-base {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 4px 12px var(--shadow-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 0; /* Remove margin-bottom as gap is handled by grid */
            border: 1px solid var(--border-color);
            position: relative;
            opacity: 0; transform: translateY(10px);
            animation: fadeInUp 0.5s ease forwards;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .card-base:hover {
            transform: translateY(-5px);
            box-shadow: 0 7px 20px rgba(0, 0, 0, 0.1);
        }

        /* Entrance Animation */
        @keyframes fadeInUp {
            to { opacity: 1; transform: translateY(0); }
        }

        /* App Card Specific Styles (Marketplace Grid & Agent List View) */
        .app-card {
            cursor: pointer; overflow: visible; /* Allow tooltip */
        }
        .app-card-content {
             display: flex; align-items: flex-start; padding: 16px; flex-grow: 1;
        }
        .app-card .app-icon {
            width: 65px; height: 65px; border-radius: 12px; margin-right: 16px;
        }
        .app-card .app-info { flex: 1; }
        .app-title { font-size: 1.1rem; font-weight: 600; color: var(--text-primary); margin-bottom: 4px; }
        .app-category {
            font-size: 0.75rem; color: var(--text-muted); margin-bottom: 8px;
            display: inline-block; padding: 3px 10px; border-radius: 12px;
            background-color: #f1f3f5; line-height: 1.3;
        }
        .app-description {
            font-size: 0.85rem; color: var(--text-secondary); line-height: 1.5;
            /* Truncate description on cards */
            display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical;
            overflow: hidden; text-overflow: ellipsis; height: calc(1.5 * 3em);
        }
        .featured-app-badge {
            position: absolute; top: 10px; right: 10px;
            background: linear-gradient(45deg, #fff176, #ffee58);
            color: #5f4300; padding: 4px 10px; border-radius: 12px;
            font-size: 0.7rem; font-weight: 700;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); z-index: 2;
        }


        /* Case Study View Styles */
        #case-studies-frame { /* The outer frame for the case study view */
            background-color: var(--frame-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 25px 30px;
            box-shadow: 0 5px 15px var(--shadow-color);
            margin-top: 1rem;
        }
        #category-filter-grid { /* 1xN grid for category filters */
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* 2 columns on small screens */
            gap: 0.75rem;
            margin-bottom: 2rem;
        }
         @media (min-width: 640px) { /* 3 columns on sm screens */
            #category-filter-grid { grid-template-columns: repeat(3, 1fr); }
         }
         @media (min-width: 1024px) { /* 6 columns on lg screens */
            #category-filter-grid { grid-template-columns: repeat(6, 1fr); }
         }
        .category-filter-btn {
            background-color: #ffffff; border: 1px solid var(--border-color);
            padding: 10px 15px; border-radius: 10px; text-align: center;
            font-weight: 500; color: var(--text-secondary); cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
            font-size: 0.85rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }
        .category-filter-btn:hover { background-color: #f8f9fa; color: var(--text-primary); }
        .category-filter-btn.active { background-color: var(--accent-color); color: white; border-color: var(--accent-color); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

        .case-study-layout { /* 2-column layout for content and index */
            display: flex; flex-direction: column; gap: 2rem;
        }
         @media (min-width: 1024px) { .case-study-layout { flex-direction: row; } }

        #case-study-display-area { flex: 3; min-width: 0; transition: opacity 0.3s ease-in-out; }
        #case-study-display-area.loading { opacity: 0.5; }

        #case-study-index { flex: 1; min-width: 220px; max-height: 75vh; overflow-y: auto; padding-right: 10px; border-left: 1px solid var(--border-color); padding-left: 1.5rem; }
         @media (max-width: 1023px) { #case-study-index { max-height: 300px; border-left: none; border-top: 1px solid var(--border-color); padding-left: 0; padding-top: 1.5rem; } }
        #case-study-index h4 { font-size: 1.1rem; font-weight: 600; color: var(--text-secondary); margin-bottom: 1rem; }
        #case-study-index ul { list-style: none; padding: 0; margin: 0; }
        #case-study-index li button { display: block; width: 100%; text-align: left; padding: 10px 15px; margin-bottom: 8px; border-radius: 8px; border: 1px solid transparent; background: none; color: var(--text-secondary); font-size: 0.9rem; cursor: pointer; transition: background-color 0.2s ease, color 0.2s ease; }
        #case-study-index li button:hover { background-color: #e9ecef; color: var(--text-primary); }
        #case-study-index li button.active { background-color: var(--accent-color); color: white; font-weight: 500; }
        #case-study-index li button span { display: block; font-size: 0.75rem; color: var(--text-muted); margin-top: 2px; }
        #case-study-index li button.active span { color: rgba(255,255,255,0.7); }

        /* Case Study Story Styles (within display area) */
        .case-study-story { padding: 0; margin-bottom: 0; opacity: 1; transform: none; animation: fadeInView 0.4s ease; }
        .case-study-story h3 { font-size: 1.8rem; font-weight: 600; color: var(--text-primary); margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid var(--border-color); display: flex; align-items: center; }
        .case-study-story .app-icon { width: 45px; height: 45px; border-radius: 10px; margin-right: 15px; font-size: 18px; }
        .case-study-story h4 { font-size: 1.15rem; font-weight: 600; color: var(--text-secondary); margin-top: 1.75rem; margin-bottom: 0.75rem; }
        .case-study-story p { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.7; margin-bottom: 1rem; }
        .case-study-story .outcome strong { color: var(--text-primary); font-weight: 600; }
        .case-study-links { margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid var(--border-color); }
        .case-study-links a { display: inline-block; margin-right: 15px; color: var(--link-color); text-decoration: none; font-weight: 500; font-size: 0.9rem; transition: color 0.2s ease; }
        .case-study-links a:hover { color: var(--link-hover-color); text-decoration: underline; }


        /* Common Icon Styles */
        .app-icon {
            background-color: #f8f9fa; display: flex; justify-content: center; align-items: center;
            font-size: 22px; font-weight: 600; color: var(--text-secondary);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); flex-shrink: 0; overflow: hidden;
        }
        .app-icon img { width: 100%; height: 100%; object-fit: cover; }


        /* Modal Styles */
        #app-details-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(33, 37, 41, 0.75); backdrop-filter: blur(8px);
            z-index: 10000; justify-content: center; align-items: center;
            opacity: 0; transition: opacity 0.4s ease;
        }
        #app-details-modal.show { display: flex; opacity: 1; }
        #app-details-content {
            background: #ffffff; border-radius: 18px; padding: 40px; width: 90%; max-width: 850px;
            max-height: 90vh; overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            position: relative; transform: scale(0.9);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        #app-details-modal.show #app-details-content { transform: scale(1); }
        #app-details-content h2 { font-size: 2rem; color: var(--text-primary); margin-bottom: 12px; font-weight: 700; }
        #app-details-content .modal-app-category {
            font-size: 0.95rem; margin-bottom: 24px; display: inline-block;
            padding: 6px 12px; border-radius: 14px; background-color: #f1f3f5; color: var(--text-muted);
        }
        #app-details-content p#modal-app-description { font-size: 1.05rem; color: var(--text-secondary); line-height: 1.7; margin-bottom: 28px; }
        #app-details-content .close-button {
            position: absolute; top: 20px; right: 20px; font-size: 2rem; font-weight: 300; color: #adb5bd;
            cursor: pointer; transition: color 0.3s ease, transform 0.3s ease; border: none; background: none; padding: 0; line-height: 1;
        }
        #app-details-content .close-button:hover { color: #dc3545; transform: rotate(90deg) scale(1.1); }
        .modal-app-icon {
            width: 110px; height: 110px; border-radius: 20px; margin-right: 24px;
            background-color: #f8f9fa; display: flex; justify-content: center; align-items: center;
            font-size: 32px; font-weight: 600; color: var(--text-secondary);
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.08); flex-shrink: 0; overflow: hidden;
        }
        .modal-app-icon img { width: 100%; height: 100%; object-fit: cover; }
        .user-rating { display: flex; align-items: center; margin-bottom: 12px; }
        .star-icon { width: 22px; height: 22px; margin-right: 5px; color: var(--star-color); }
        .rating-count { font-size: 0.95rem; color: var(--text-secondary); }
        .comments-section h3 { font-size: 1.25rem; font-weight: 600; color: var(--text-primary); margin-bottom: 16px; }
        .comment { padding: 14px; margin-bottom: 14px; border-radius: 10px; background-color: #f8f9fa; border: 1px solid var(--border-color); }
        .comment-author { font-size: 0.9rem; font-weight: 600; color: var(--text-primary); margin-bottom: 4px; }
        .comment-text { font-size: 0.9rem; color: var(--text-secondary); line-height: 1.5; }

        /* Filter Dropdown Styles */
        #filter-dropdown { position: relative; display: inline-block; }
        #filter-dropdown button {
            background-color: #ffffff;
            color: var(--text-secondary); padding: 10px 20px; border-radius: 20px; border: 1px solid var(--border-color);
            cursor: pointer; font-size: 0.9rem; font-weight: 500;
            transition: background-color 0.3s ease, box-shadow 0.3s ease, color 0.3s ease;
            display: flex; align-items: center;
        }
        #filter-dropdown button:hover {
            background-color: #f8f9fa; color: var(--text-primary); box-shadow: 0 2px 5px var(--shadow-color);
        }
        #filter-dropdown button span { margin-right: 6px; }
        #filter-dropdown ul {
            position: absolute; top: calc(100% + 8px); right: 0;
            background-color: #ffffff; border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1); padding: 10px 0; list-style: none;
            min-width: 260px; opacity: 0; visibility: hidden;
            transform: translateY(-10px) scale(0.95);
            transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
            z-index: 1001; border: 1px solid var(--border-color);
        }
        #filter-dropdown.show ul { opacity: 1; visibility: visible; transform: translateY(0) scale(1); }
        #filter-dropdown ul li {
            padding: 10px 18px; font-size: 0.9rem; color: var(--text-secondary); cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease; white-space: normal; line-height: 1.4;
        }
        #filter-dropdown ul li:hover { background-color: #f1f3f5; color: var(--text-primary); }
        #filter-dropdown ul li.active { font-weight: 600; color: var(--text-primary); background-color: #e9ecef; }

        /* AI Search Styles */
        #ai-search-container {
            display: flex; align-items: center; background-color: #ffffff;
            padding: 6px 12px; border-radius: 20px; border: 1px solid var(--border-color);
            flex-grow: 1; max-width: 400px;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
         #ai-search-container:focus-within {
            background-color: #ffffff; box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
        }
        #ai-search-input {
            flex-grow: 1; border: none; background: transparent; outline: none;
            padding: 8px; font-size: 0.9rem; color: var(--text-primary);
        }
        #ai-search-input::placeholder { color: var(--text-muted); }
        #ai-search-button {
            background: none; border: none; cursor: pointer; padding: 6px; color: var(--text-muted);
            transition: color 0.3s ease;
        }
        #ai-search-button:hover { color: var(--text-primary); }
        #ai-response-area {
            margin: 20px auto 0 auto; max-width: 1400px;
            padding: 18px 24px; background: #ffffff;
            border-radius: 14px; box-shadow: 0 5px 15px var(--shadow-color);
            font-size: 1rem; color: var(--text-primary); line-height: 1.6; display: none;
            border: 1px solid var(--border-color);
        }
        #ai-response-area.loading::after { content: 'Thinking...'; display: block; text-align: center; font-style: italic; color: var(--text-muted); margin-top: 12px; }
        .ai-result-link { font-weight: 500; color: var(--link-color); text-decoration: none; transition: color 0.2s ease; }
        .ai-result-link:hover { color: var(--link-hover-color); text-decoration: underline; }
        .ai-result-category { font-size: 0.9em; color: var(--text-muted); margin-left: 6px; }

        /* No Apps/Agents Message & View Title Styles */
        .no-apps-message, .no-agents-message {
            text-align: center; font-size: 1.1rem; color: var(--text-muted);
            margin-top: 50px; padding: 25px; border-radius: 14px;
            background-color: #ffffff; border: 1px solid var(--border-color);
        }
        .view-title {
            font-size: 2rem; font-weight: 600; color: var(--text-primary);
            margin-bottom: 1.5rem; padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        /* Main Content Area & View Switching Styles */
        main {
            flex: 1; padding: 0; /* Remove padding from main, apply to sections */
            max-width: 100%; /* Allow sections to control width */
            margin: 0 auto;
            width: 100%; box-sizing: border-box;
        }
        .view-section { display: none; animation: fadeInView 0.5s ease forwards; padding: 1.5rem; } /* Add padding to view sections */
        .view-section.active { display: block; }
        @keyframes fadeInView {
             from { opacity: 0; transform: translateY(10px); }
             to { opacity: 1; transform: translateY(0); }
        }
        /* Grid layout */
        .grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px;
        }
        /* Specific styles for #app-list when visible */
        #app-list:not(.hidden) {
             padding: 2rem 0; /* Add vertical padding when shown */
             max-width: 1400px; /* Ensure max-width */
             margin: 0 auto; /* Center grid */
        }


        /* Apple-Inspired Section Styles */
        .large-section {
            padding: 4rem 2rem; /* Generous padding */
            text-align: center;
        }
        .large-section.bg-light { background-color: var(--section-bg-light); }
        .large-section.bg-dark { background-color: var(--section-bg-dark); }

        .section-title {
            font-size: 2.5rem; /* Larger title */
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }
         .section-subtitle {
            font-size: 1.25rem;
            color: var(--text-secondary);
            max-width: 700px; /* Constrain width */
            margin: 0 auto 2.5rem auto; /* Center and add bottom margin */
            line-height: 1.6;
        }

        /* Featured Agent Card Styles */
        .featured-agent-card {
            background-color: var(--card-bg);
            border-radius: 20px; /* More rounded */
            padding: 2rem;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--border-color);
        }
        .featured-agent-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.12);
        }
        .featured-agent-card .app-icon {
            width: 80px; height: 80px; margin: 0 auto 1.5rem auto; /* Center icon */
            border-radius: 18px; font-size: 28px;
        }
        .featured-agent-card .app-title {
            font-size: 1.5rem; margin-bottom: 0.5rem;
        }
        .featured-agent-card .app-category {
             font-size: 0.9rem; margin-bottom: 1rem;
        }
        .featured-agent-card .app-description {
            font-size: 0.95rem; height: auto; /* Allow full description */
             -webkit-line-clamp: unset;
             margin-bottom: 1.5rem;
        }
         .featured-agent-card .learn-more-link {
             font-weight: 500; color: var(--link-color); text-decoration: none;
         }
         .featured-agent-card .learn-more-link:hover {
             color: var(--link-hover-color); text-decoration: underline;
         }

        /* Category Showcase Card Styles */
        .category-showcase-card {
            background-color: var(--card-bg);
            border-radius: 18px;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 6px 20px rgba(0,0,0,0.06);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
             border: 1px solid var(--border-color);
             display: flex;
             flex-direction: column;
             align-items: center;
             justify-content: center;
             min-height: 250px; /* Ensure cards have some height */
        }
         .category-showcase-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .category-showcase-card .category-icon { /* Placeholder for category icon */
             font-size: 2.5rem;
             margin-bottom: 1rem;
             color: var(--accent-color);
        }
        .category-showcase-card .category-card-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }
         .category-showcase-card .category-card-desc {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.5;
             flex-grow: 1; /* Allow desc to take space */
             margin-bottom: 1rem;
        }
         .category-showcase-card .learn-more-link {
             font-weight: 500; color: var(--link-color); text-decoration: none; font-size: 0.9rem;
         }
         .category-showcase-card .learn-more-link:hover {
             color: var(--link-hover-color); text-decoration: underline;
         }

         /* Frame container - Used for multiple views */
        .content-frame { /* Renamed for general use */
            background-color: var(--frame-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 25px 30px; /* Internal padding */
            box-shadow: 0 5px 15px var(--shadow-color);
            margin-top: 1rem; /* Space below section title */
            margin-bottom: 1rem; /* Space below frame */
        }


        /* Tooltip Styles */
        #app-tooltip {
            position: absolute; background-color: var(--tooltip-bg); color: var(--tooltip-text);
            padding: 8px 12px; border-radius: 6px; font-size: 0.85rem; line-height: 1.4;
            z-index: 11000; opacity: 0; visibility: hidden; pointer-events: none;
            transition: opacity 0.2s ease; max-width: 250px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
         #app-tooltip h3 { font-weight: 600; margin: 0 0 4px 0; font-size: 0.9rem; color: #ffffff; }
         #app-tooltip p { margin: 0; }
         #app-tooltip .tooltip-category { color: #ced4da; margin-bottom: 3px; }
         #app-tooltip .tooltip-rating { color: var(--star-color); }

        /* Responsive Design Adjustments */
        @media (max-width: 1024px) {
            .header-content { justify-content: space-between; }
            header nav { order: 3; width: 100%; justify-content: center; margin-top: 0.5rem; gap: 1rem;}
            .header-actions { order: 2; }
            .header-title { order: 1; }
            #ai-search-container { max-width: 300px; }
            .section-title { font-size: 2rem; }
            .section-subtitle { font-size: 1.1rem; }
            .case-study-layout { flex-direction: column; } /* Stack columns earlier */
            #case-study-index { max-height: 300px; border-left: none; border-top: 1px solid var(--border-color); padding-left: 0; padding-top: 1.5rem; }
        }
        @media (max-width: 768px) {
            header { padding: 0.75rem 1rem; }
            .header-title { font-size: 1.5rem; }
            header nav { gap: 0.75rem; }
            header nav a { font-size: 0.9rem; padding: 0.3rem 0; }
            .header-actions { flex-wrap: wrap; justify-content: flex-end; gap: 0.5rem; }
             #ai-search-container { width: 100%; max-width: none; order: 1; margin-right: 0; }
             #filter-dropdown { order: 2; }
             #filter-dropdown button { padding: 8px 16px; }
             main { padding: 0; } /* Remove main padding, handled by sections */
             .view-section { padding: 1rem; } /* Adjust view padding */
             .large-section { padding: 3rem 1rem; }
             .grid { grid-template-columns: 1fr; gap: 20px; } /* Stack grids on small screens */
             #app-list:not(.hidden) { padding: 2rem 0; } /* Adjust dynamic grid padding */
             #app-details-content { padding: 25px; }
             #app-details-content h2 { font-size: 1.6rem; }
             #app-tooltip { display: none; }
             .view-title { font-size: 1.5rem; margin-bottom: 1rem; padding: 0;} /* Remove padding from view titles */
             .case-study-story { padding: 15px 20px; }
             .section-title { font-size: 1.8rem; }
             .section-subtitle { font-size: 1rem; }
             .featured-agent-card { padding: 1.5rem; }
             .category-showcase-card { padding: 1.5rem; min-height: 200px;}
             .content-frame { padding: 15px 20px; } /* Adjust frame padding */
             #category-filter-grid { grid-template-columns: repeat(2, 1fr); } /* Ensure 2 columns on small */
        }

    </style>
</head>
<body class="min-h-screen flex flex-col">
    <div id="loading-screen">
        <div class="loader"></div>
    </div>

    <header>
        <div class="header-content">
            <a href="https://synapster.analystx.uk/" class="header-title site-nav-link" data-target="marketplace-view">AI Agent Marketplace</a>
            <nav>
                <a href="https://synapster.analystx.uk/cs.html" class="site-nav-link" >Case Studies</a>
                <a href="https://synapster.analystx.uk/agents.html" class="site-nav-link" >Agents List</a>
                <a href="https://synapster.analystx.uk/discussion.html" class="site-nav-link" >Forum</a> 
                <a href="https://synapster.analystx.uk/about.html" class="site-nav-link" data-target="about-view">About Us</a>
            </nav>
            <div class="header-actions">
                <div id="ai-search-container">
                    <input type="text" id="ai-search-input" placeholder="Ask the AI Agent...">
                    <button id="ai-search-button" aria-label="Search">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                    </button>
                </div>
                <div id="filter-dropdown">
                    <button>
                        <span>Filter</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m7 10 5 5 5-5"/></svg>
                    </button>
                    <ul>
                        <li data-category="all">All Categories</li>
                        <li data-category="diagnostics-imaging">Diagnostics & Imaging Solutions</li>
                        <li data-category="clinical-decision">Clinical Decision Support & Triage</li>
                        <li data-category="patient-engagement">Patient Engagement & Remote Care</li>
                        <li data-category="operational-efficiency">Operational Efficiency & Administration</li>
                        <li data-category="drug-discovery">Drug Discovery & Research</li>
                    </ul>
                </div>
            </div>
        </div>
        <div id="ai-response-area"></div>
    </header>
    <main>
        <h1 class="page-title">AI Agent Case Studies</h1>

        <div id="page-frame-container">

            <div id="category-filter-grid">
                 <button class="category-filter-btn active" data-category="all">All Case Studies</button>
                 <button class="category-filter-btn" data-category="diagnostics-imaging">Diagnostics</button>
                 <button class="category-filter-btn" data-category="clinical-decision">Clinical Decision</button>
                 <button class="category-filter-btn" data-category="patient-engagement">Patient Engagement</button>
                 <button class="category-filter-btn" data-category="operational-efficiency">Operations</button>
                 <button class="category-filter-btn" data-category="drug-discovery">Research</button>
            </div>

            <div class="case-study-layout">
                <div id="case-study-display-area">
                    <p class="text-center text-muted py-10">Select a case study from the index to view details.</p>
                </div>
                <div id="case-study-index">
                    <h4>Case Study Index</h4>
                    <ul id="case-study-index-list">
                        </ul>
                </div>
            </div>

        </div> </main>

    <script>
      try { // Add error handling wrapper

        // --- Category Mapping (Slug to Full Name) ---
        const categoryMap = {
            'all': 'All Categories',
            'diagnostics-imaging': 'Diagnostics & Imaging Solutions',
            'clinical-decision': 'Clinical Decision Support & Triage',
            'patient-engagement': 'Patient Engagement & Remote Care',
            'operational-efficiency': 'Operational Efficiency & Administration',
            'drug-discovery': 'Drug Discovery & Research'
        };

        // --- Case Study Data (Extracted from appData) ---
        // This data would typically come from a database or API in a real application
        const caseStudiesData = [
            { appId: 'diag01', title: 'Zebra Medical Vision', category: 'diagnostics-imaging', icon: 'ZMV', iconUrl: 'https://placehold.co/80x80/ADB5BD/ffffff?text=ZMV', caseStudy: { country: 'United Kingdom', improvement: 'Reduced diagnostic report turnaround time by 25% in NHS trusts, leading to faster treatment decisions.', problem: 'Significant backlogs in interpreting diagnostic images (X-rays, CT scans) led to delays in patient diagnosis and treatment initiation. Radiologist workload was high, contributing to burnout.', solution: 'The AI platform was integrated into the existing PACS system, automatically analysing incoming scans, flagging potential abnormalities and prioritising urgent cases for radiologist review. The AI acted as a "second reader".'} },
            { appId: 'diag02', title: 'Rad AI', category: 'diagnostics-imaging', icon: 'RAI', iconUrl: 'https://placehold.co/80x80/CED4DA/ffffff?text=RAI', caseStudy: { country: 'USA', improvement: 'Automated report generation saved radiologists an average of 60 minutes per day at a California-based health system.', problem: 'A large California-based health system struggled with the time radiologists spent on repetitive reporting tasks and ensuring consistent report quality, detracting from complex image interpretation.', solution: 'Rad AI\'s tools integrated into the workflow, automatically generating customisable report templates populated with data and standard language, reducing manual dictation and formatting time.'} },
            { appId: 'diag03', title: 'Gleamer', category: 'diagnostics-imaging', icon: 'GLM', iconUrl: 'https://placehold.co/80x80/DEE2E6/495057?text=GLM', caseStudy: { country: 'France', improvement: 'Improved fracture detection accuracy by 15% in emergency rooms, reducing misdiagnosis rates.', problem: 'Emergency departments faced challenges with the speed and accuracy of preliminary fracture detection on X-rays, especially during busy periods, leading to missed fractures.', solution: 'BoneView was implemented alongside standard review, analysing X-rays and highlighting suspected fracture sites directly on the image, serving as a crucial aid for subtle or complex fractures.'} },
            { appId: 'clin01', title: 'Pieces', category: 'clinical-decision', icon: 'PCS', iconUrl: 'https://placehold.co/80x80/6C757D/ffffff?text=PCS', caseStudy: { country: 'USA', improvement: 'Helped a Dallas hospital reduce readmission rates for high-risk patients by 18% through better care coordination.', problem: 'A major Dallas hospital identified high readmission rates among patients with complex conditions, often exacerbated by fragmented communication and siloed data.', solution: 'The Pieces platform integrated clinical and social determinants data, using AI to identify high-risk patients in real-time and alert care managers to specific needs, enabling proactive interventions.'} },
            { appId: 'clin02', title: 'Visiba', category: 'clinical-decision', icon: 'VIS', iconUrl: 'https://placehold.co/80x80/ADB5BD/ffffff?text=VIS', caseStudy: { country: 'Sweden', improvement: 'Directed 30% more patients to the appropriate level of care (nurse, physio, GP) on first contact, optimising resource use.', problem: 'Urgent care centres faced high volumes and difficulties efficiently directing patients to the correct care pathway based on initial contact, causing bottlenecks.', solution: 'Patients used an online portal; Visiba Triage AI analysed symptoms, suggested urgency/diagnoses, and provided a structured summary to the clinical team for faster, informed routing decisions.'} },
            { appId: 'clin03', title: 'Klinik Healthcare Solutions', category: 'clinical-decision', icon: 'KHS', iconUrl: 'https://placehold.co/80x80/CED4DA/495057?text=KHS', caseStudy: { country: 'Finland', improvement: 'Reduced unnecessary GP appointments by 20% in primary care centres by accurately assessing patient needs online.', problem: 'Primary care centres were overwhelmed with high call volumes and administrative workload for booking and assessment, hindering timely patient access.', solution: 'The online platform allowed patients to submit enquiries; AI assessed urgency and directed the query to the most suitable resource (GP, nurse, pharmacist), reducing phone traffic.'} },
            { appId: 'pat01', title: 'Memora Health', category: 'patient-engagement', icon: 'MEM', iconUrl: 'https://placehold.co/80x80/DEE2E6/ffffff?text=MEM', caseStudy: { country: 'USA', improvement: 'Increased patient adherence to post-operative instructions by 40% through automated check-ins and reminders.', problem: 'A hospital system observed low adherence to complex post-operative instructions, leading to complications. Manual follow-up was difficult to scale.', solution: 'The platform automated SMS communication, sending personalised reminders and using AI chat for common questions, flagging concerns for clinical review.'} },
            { appId: 'pat02', title: 'Ada Health', category: 'patient-engagement', icon: 'ADA', iconUrl: 'https://placehold.co/80x80/E9ECEF/495057?text=ADA', caseStudy: { country: 'Germany', improvement: 'Provided preliminary symptom assessments for over 10 million users, guiding them towards appropriate care options.', problem: 'Patients often struggled to understand symptoms or determine the appropriate level of care needed, leading to inefficient use of emergency services or delayed care.', solution: 'The Ada app allowed users to input symptoms; AI asked relevant questions and provided reports outlining possible causes and recommended next steps.'} },
            { appId: 'pat03', title: 'Biofourmis', category: 'patient-engagement', icon: 'BIO', iconUrl: 'https://placehold.co/80x80/F8F9FA/6C757D?text=BIO', caseStudy: { country: 'Singapore', improvement: 'Enabled early detection of heart failure decompensation in remotely monitored patients, reducing hospitalisations by 30%.', problem: 'Detecting early signs of worsening chronic heart failure in remotely managed patients was challenging, often leading to avoidable emergency hospitalisations.', solution: 'Wearable sensors collected data analysed by the Biovitals® AI platform, which detected subtle changes indicating potential issues, alerting clinicians for proactive intervention.'} },
            { appId: 'ops01', title: 'Avaamo', category: 'operational-efficiency', icon: 'AVA', iconUrl: 'https://placehold.co/80x80/ADB5BD/ffffff?text=AVA', caseStudy: { country: 'India', improvement: 'Automated appointment scheduling for a large hospital network, reducing call centre volume by 35%.', problem: 'A large hospital network faced operational inefficiencies due to high call volumes for appointments and basic inquiries, straining staff resources.', solution: 'AI virtual assistants deployed on the website and phone system handled routine tasks like booking, FAQs, and pre-appointment guidance, freeing up staff.'} },
            { appId: 'ops02', title: 'AKASA', category: 'operational-efficiency', icon: 'AKA', iconUrl: 'https://placehold.co/80x80/6C757D/ffffff?text=AKA', caseStudy: { country: 'USA', improvement: 'Reduced claim denial rates by 22% and accelerated payment cycles for multiple healthcare providers.', problem: 'Healthcare providers experienced revenue loss and administrative burden due to medical coding errors, complex billing, and high claim denial rates.', solution: 'The AI platform integrated with EHR/billing systems to automate tasks, correct coding errors pre-submission, predict denials, and manage appeals.'} },
            { appId: 'ops03', title: 'Augmedix', category: 'operational-efficiency', icon: 'AUG', iconUrl: 'https://placehold.co/80x80/CED4DA/495057?text=AUG', caseStudy: { country: 'USA', improvement: 'Saved primary care physicians an average of 2-3 hours per day on documentation, improving job satisfaction.', problem: 'Physicians reported high burnout levels largely due to the burden of clinical documentation within EHRs, reducing time for patient interaction.', solution: 'AI-assisted remote medical documentation specialists generated draft clinical notes in real-time during patient visits, which were then finalised, significantly cutting physician documentation time.'} },
            { appId: 'drug01', title: 'Atomwise', category: 'drug-discovery', icon: 'ATW', iconUrl: 'https://placehold.co/80x80/DEE2E6/ffffff?text=ATW', caseStudy: { country: 'Global (Partnerships)', improvement: 'Identified potential drug candidates for various targets significantly faster than traditional high-throughput screening methods.', problem: 'Traditional drug discovery faced bottlenecks in the early hit-finding stage due to the time and cost of high-throughput screening (HTS).', solution: 'The AtomNet® AI platform used deep learning to predict molecule binding affinity, identifying novel hit compounds faster and more cost-effectively than HTS.'} },
            { appId: 'drug02', title: 'Isomorphic Labs', category: 'drug-discovery', icon: 'ISO', iconUrl: 'https://placehold.co/80x80/E9ECEF/495057?text=ISO', caseStudy: { country: 'UK/Global', improvement: 'Advanced protein structure prediction capabilities (AlphaFold), fundamentally accelerating biological research worldwide.', problem: 'Determining the 3D structure of proteins experimentally was often slow, expensive, or impossible, hindering drug design and biological understanding.', solution: 'AI systems like AlphaFold were developed to predict protein structures accurately from amino acid sequences, providing invaluable tools for global researchers.'} },
            { appId: 'drug03', title: 'XtalPi', category: 'drug-discovery', icon: 'XTP', iconUrl: 'https://placehold.co/80x80/F8F9FA/6C757D?text=XTP', caseStudy: { country: 'USA/China', improvement: 'Utilised AI and physics-based models to predict crystal structures, shortening pre-clinical development timelines.', problem: 'Predicting and controlling the solid-state properties (like crystal structure) of drug candidates was often a slow, trial-and-error process.', solution: 'The platform combined quantum physics calculations, AI predictions, and robotics to accurately predict solid-state properties, guiding experiments and optimising candidate selection.'} },
            { appId: 'drug04', title: 'Healx', category: 'drug-discovery', icon: 'HLX', iconUrl: 'https://placehold.co/80x80/ADB5BD/ffffff?text=HLX', caseStudy: { country: 'UK', improvement: 'Identified potential treatments for rare diseases by repurposing existing drugs, moving candidates towards clinical trials faster.', problem: 'Developing treatments for rare diseases faced challenges due to small patient populations and the high cost/risk of traditional drug development.', solution: 'The Healnet AI platform analysed vast biomedical data to find non-obvious links between existing drugs and rare diseases, accelerating the identification of potential repurposed treatments.'} }
        ];


        // --- DOM Element References ---
        const caseStudyDisplayArea = document.getElementById('case-study-display-area');
        const caseStudyIndexList = document.getElementById('case-study-index-list');
        const categoryFilterGrid = document.getElementById('category-filter-grid');

        // Check if critical elements exist
        if (!caseStudyDisplayArea || !caseStudyIndexList || !categoryFilterGrid) {
            console.error("Initialization Error: Case study container elements not found.");
        }

        // --- State ---
        let currentCaseStudyCategory = 'all';

        // --- Helper to generate fictional content ---
        const generateFictionalContent = (app) => {
            const methodology = app.caseStudy.solution || `The ${app.title || 'AI'} platform was implemented within the client's existing infrastructure. It leveraged its core AI capabilities, processing relevant data streams (e.g., ${app.category === 'diagnostics-imaging' ? 'medical images, reports' : app.category === 'patient-engagement' ? 'wearable data, patient communications' : 'operational metrics, EHR data'}) to provide actionable insights. Integration with systems like PACS or EHR was established where necessary to ensure seamless workflow. Staff were trained on utilising the platform's outputs for enhanced decision-making.`;
            const conclusion = `The deployment successfully addressed the core problem statement. Key outcomes included: ${app.caseStudy.improvement}. This demonstrates the effectiveness of ${app.title || 'the AI agent'} in enhancing healthcare efficiency and outcomes in ${app.caseStudy.country || 'this region'}.`;
            const recommendation = `Based on the positive results observed in ${app.caseStudy.country || 'this study'}, wider adoption of ${app.title || 'this AI solution'} is recommended for similar healthcare settings facing challenges in ${categoryMap[app.category] || 'related fields'}. Further investigation into long-term cost-benefit analysis and patient satisfaction metrics would provide additional valuable insights.`;
            const nextStep = `The next phase involves ongoing monitoring of key performance indicators to ensure sustained improvements. Potential expansions include integrating additional data sources or applying the AI agent to related clinical or operational areas. Continuous user feedback collection is planned to guide future refinements and updates to the platform.`;
            const intro = `A leading healthcare provider in ${app.caseStudy.country || 'the region'} sought to innovate within the area of ${categoryMap[app.category] || 'healthcare services'}. Facing increasing demands and complexity, they partnered with ${app.title || 'an AI solutions provider'} to explore how artificial intelligence could address specific operational or clinical challenges and improve overall service delivery.`;
            return { methodology, conclusion, recommendation, nextStep, intro };
        };

        // --- Function to Display a Single Case Study Story ---
        function displaySingleCaseStudyById(appId) {
             if (!caseStudyDisplayArea) return;

             const app = caseStudiesData.find(item => item.appId === appId);

             if (!app || !app.caseStudy) {
                 caseStudyDisplayArea.innerHTML = '<p class="text-center text-muted py-10">Case study details not available.</p>';
                 return;
             };

             console.log("Displaying case study for:", app.title); // Debug
             caseStudyDisplayArea.classList.add('loading'); // Indicate loading start

             const fallbackImage = `this.onerror=null; this.parentElement.textContent = '${app.icon || '?'}'; this.parentElement.style.fontSize='18px'; this.parentElement.style.fontWeight='600';`;
             const fictional = generateFictionalContent(app);

             // Build the story HTML
             const storyHTML = `
                 <div class="case-study-story">
                     <h3>
                         <div class="app-icon">
                              <img src="${app.iconUrl || '#'}" alt="${app.title || 'Agent'} icon" loading="lazy" onerror="${fallbackImage}">
                         </div>
                         ${app.title || 'Unknown Agent'} Case Study
                     </h3>
                     <h4>Introduction</h4>
                     <p>${fictional.intro}</p>
                     <h4>Problem Statement</h4>
                     <p>${app.caseStudy.problem || 'Details not available.'}</p>
                     <h4>Methodology</h4>
                     <p>${fictional.methodology}</p>
                     <h4>Conclusion & Outcome</h4>
                     <p class="outcome">${fictional.conclusion}</p>
                     <h4>Recommendation</h4>
                     <p>${fictional.recommendation}</p>
                     <h4>Next Steps</h4>
                     <p>${fictional.nextStep}</p>
                     <div class="case-study-links">
                         <a href="#" target="_blank" rel="noopener noreferrer">Read Full Study (Placeholder)</a>
                         <a href="#" target="_blank" rel="noopener noreferrer">Visit Product Page (Placeholder)</a>
                     </div>
                 </div>
             `;
             // Use a small timeout to allow the 'loading' class effect to be visible
             setTimeout(() => {
                caseStudyDisplayArea.innerHTML = storyHTML;
                caseStudyDisplayArea.classList.remove('loading');
             }, 100); // 100ms delay

             // Update active state in index
             if(caseStudyIndexList) {
                caseStudyIndexList.querySelectorAll('button').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.appid === appId);
                });
             }
         }

        // --- Function to Populate Case Study Index ---
        function populateIndex(filteredStudies) {
            if (!caseStudyIndexList || !caseStudyDisplayArea) return;
            caseStudyIndexList.innerHTML = ''; // Clear previous index

            if (filteredStudies.length === 0) {
                caseStudyIndexList.innerHTML = '<li class="text-muted text-sm p-3">No studies found.</li>';
                caseStudyDisplayArea.innerHTML = '<p class="text-center text-muted py-10">No case studies match the selected category.</p>';
            } else {
                filteredStudies.forEach((study) => {
                    const listItem = document.createElement('li');
                    const button = document.createElement('button');
                    button.dataset.appid = study.appId;
                    // Use study.title and study.category directly from the filtered data
                    button.innerHTML = `${study.title || 'Unknown'} <span>${categoryMap[study.category] || study.category || 'N/A'}</span>`;
                    // Add click listener to load this study
                    button.addEventListener('click', () => displaySingleCaseStudyById(study.appId));
                    listItem.appendChild(button);
                    caseStudyIndexList.appendChild(listItem);
                });
                // Display the first study in the filtered list by default
                displaySingleCaseStudyById(filteredStudies[0].appId);
            }
        }

        // --- Function to Filter Case Studies by Category ---
        function filterCaseStudiesByCategory(category) {
            if (!categoryFilterGrid) return;
            currentCaseStudyCategory = category;
            console.log("Filtering by category:", category); // Debug

            const filteredData = (category === 'all')
                ? caseStudiesData // Use the dedicated case study data
                : caseStudiesData.filter(study => study.category === category);

            populateIndex(filteredData); // Repopulate index and display first item

            // Update active state for category buttons
            const categoryButtons = categoryFilterGrid.querySelectorAll('.category-filter-btn');
            categoryButtons.forEach(btn => {
                 btn.classList.toggle('active', btn.dataset.category === category);
             });
        }

        // --- Initialisation on Page Load ---
        document.addEventListener('DOMContentLoaded', () => {
            try {
                console.log("DOM Loaded for Case Studies Page"); // Debug

                // Add listeners to category buttons
                const categoryButtons = categoryFilterGrid?.querySelectorAll('.category-filter-btn');
                if (categoryButtons) {
                    categoryButtons.forEach(button => {
                        button.addEventListener('click', () => filterCaseStudiesByCategory(button.dataset.category));
                    });
                } else {
                     console.error("Category filter buttons not found.");
                }

                // Initial population
                filterCaseStudiesByCategory('all'); // Show all initially

            } catch (error) {
                console.error("Error during initial page load:", error);
                const body = document.querySelector('body');
                 if (body) {
                     body.innerHTML = '<p style="padding: 20px; text-align: center; color: red;">Sorry, the application could not be loaded. Please check the console for errors.</p>';
                 }
            }
        });

      } catch (e) { // Catch errors during script setup phase
            console.error("Critical error during script setup:", e);
            const body = document.querySelector('body');
            if (body) {
                 body.innerHTML = '<p style="padding: 20px; text-align: center; color: red;">A critical error occurred while setting up the page. Please check the console.</p>';
            }
      }
    </script>

</body>
</html>
